<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>M3U8æ’­æ”¾å™¨åœ¨çº¿ - å…è´¹HLSè§†é¢‘æ’­æ”¾å·¥å…· | ArtPlayeré©±åŠ¨</title>
    <meta name="description" content="æ— éœ€å®‰è£…ï¼Œåœ¨çº¿æ’­æ”¾M3U8ã€MP4è§†é¢‘ï¼Œæ”¯æŒHLSè‡ªé€‚åº”ç ç‡ã€å¼¹å¹•ã€å­—å¹•ã€æˆªå›¾ã€å€é€Ÿã€‚åŸºäºArtPlayerï¼Œæ‰‹æœºã€ç”µè„‘å³å¼€å³æ’­ã€‚">
    <meta name="keywords" content="m3u8æ’­æ”¾å™¨,hlsæ’­æ”¾å™¨,åœ¨çº¿m3u8,åœ¨çº¿hls,artplayerç½‘é¡µæ’­æ”¾å™¨">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="./css/styles.css">
    <style>
        .card { margin-top: 18px; overflow: hidden }

        #player {
            width: 100%;
            aspect-ratio: 16 / 9;
            background-color: #000;
        }

        /* æ‰©å¤§è¿›åº¦æ¡çš„å¯ç‚¹å‡»/æ‹–åŠ¨çƒ­åŒºè€Œä¸å½±å“å¸ƒå±€é«˜åº¦ */
        #player .art-progress {
            padding-top: 20px;
            padding-bottom: 20px;
            margin-top: -20px;
            margin-bottom: -20px
        }

    </style>
</head>

<body>
    <!-- é¡¶éƒ¨èœå•æ  -->
    <div class="topbar">
        <a href="index.html" class="active">é¦–é¡µ</a>
        <a href="docs.html">æ–‡ç« é¡µ</a>
    </div>


    <div class="shell">
        <div class="nav">
            <div class="brand">
                <span class="dot"></span>
                <span>M3U8 æ’­æ”¾å™¨</span>
            </div>
            <div class="controls">
                <div class="input">
                    <input id="urlInput" type="text" placeholder="è¯·è¾“å…¥ m3u8 æˆ– mp4 åœ°å€"
                        value="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8">
                </div>
                <button class="btn secondary" onclick="loadDemo()">ç¤ºä¾‹</button>
                <button class="btn" onclick="playVideo()">æ’­æ”¾</button>
            </div>
        </div>

        <div id="alert" class="alert"></div>

        <div class="card">
            <div id="player"></div>
        </div>

        <div class="remark">
            <h3>ä»€ä¹ˆæ˜¯ArtPlayerï¼Ÿ</h3>
            <p>
                ArtPlayer â€” è½»é‡çº§ã€å…¨åŠŸèƒ½ HTML5 è§†é¢‘æ’­æ”¾å™¨,æ”¯æŒ MP4 / HLS / FLV / WebM ç­‰ä¸»æµæ ¼å¼ï¼Œå¹¶å†…ç½®å¼¹å¹•ã€å­—å¹•ã€æ¸…æ™°åº¦åˆ‡æ¢ã€æˆªå›¾ã€ç”»ä¸­ç”»ã€å€é€Ÿæ’­æ”¾ç­‰ä¸°å¯ŒåŠŸèƒ½ã€‚
            </p>

            <h3>ä»€ä¹ˆæ˜¯m3u8æ–‡ä»¶ï¼Ÿ</h3>
            <p>
                <strong>M3U8</strong> æ˜¯ä¸€ç§åŸºäº UTF-8 ç¼–ç çš„æ’­æ”¾åˆ—è¡¨ï¼ˆplaylistï¼‰æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰©å±•åä¸º <code>.m3u8</code>ã€‚
                å®ƒæœ¬èº«å¹¶ä¸åŒ…å«è§†é¢‘æ•°æ®ï¼Œè€Œæ˜¯æŒ‰é¡ºåºåˆ—å‡ºè‹¥å¹² <em>TS åˆ‡ç‰‡</em>ï¼ˆå°ç‰‡æ®µï¼‰æˆ–ä¸åŒæ¸…æ™°åº¦çš„å­æµåœ°å€ï¼Œä¾›æ’­æ”¾å™¨æŒ‰éœ€æ‹‰å–å¹¶æ— ç¼æ‹¼æ¥æ’­æ”¾ï¼Œå› æ­¤æ˜¯å®ç° <strong>HLSï¼ˆHTTP Live
                    Streamingï¼‰</strong> çš„æ ¸å¿ƒæ–‡ä»¶ã€‚
            </p>


            <h3>æ ¸å¿ƒç‰¹ç‚¹</h3>
            <ul>
                <li>ğŸ“¡ <strong>è‡ªé€‚åº”ç ç‡</strong>ï¼šåŒä¸€ M3U8 å¯å¼•ç”¨ 240pã€480pã€720p ç­‰å¤šæ¡å­æµï¼Œæ’­æ”¾å™¨æ ¹æ®ç½‘ç»œå®æ—¶åˆ‡æ¢ã€‚</li>
                <li>ğŸ§© <strong>åˆ‡ç‰‡ä¼ è¾“</strong>ï¼šè§†é¢‘è¢«åˆ‡æˆ 2-10 ç§’å°ç‰‡æ®µï¼Œé™ä½é¦–å¸§ç­‰å¾…å¹¶æ”¯æŒè¾¹ä¸‹è¾¹æ’­ã€‚</li>
                <li>ğŸŒ <strong>çº¯ HTTP åˆ†å‘</strong>ï¼šæ— éœ€ç‰¹æ®Šåè®®ï¼Œä»»ä½• CDNã€Nginxã€Apache å‡å¯ç›´æ¥æ‰˜ç®¡ã€‚</li>
                <li>ğŸ“ <strong>çº¯æ–‡æœ¬æ ¼å¼</strong>ï¼šå¯ç”¨ä»»æ„ç¼–è¾‘å™¨æŸ¥çœ‹ï¼Œæ–¹ä¾¿è°ƒè¯•ä¸äºŒæ¬¡å¼€å‘ã€‚</li>
            </ul>

            <h3>å…¸å‹ç»“æ„ç¤ºä¾‹</h3>
            <pre><code class="language-text">#EXTM3U
#EXT-X-VERSION:3
#EXT-X-TARGETDURATION:6
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:6.000,
segment0.ts
#EXTINF:6.000,
segment1.ts
#EXT-X-ENDLIST
</code></pre>

        </div>

        <div class="wise_saying">
            <b>é”²è€Œä¸èˆï¼Œé‡‘çŸ³å¯é•‚ã€‚â€”â€”ã€Šè€å­Â·åŠå­¦ã€‹</b>
        </div>

        <div class="footer">
            <span>å‹æƒ…é“¾æ¥ï¼š</span>
            <a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>
            <span>Â·</span>
            <a href="https://www.cnblogs.com/" target="_blank" rel="noopener">åšå®¢å›­</a>
            <span>Â·</span>
            <a href="https://artplayer.org/" target="_blank" rel="noopener">ArtPlayer å®˜ç½‘</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/artplayer@5/dist/artplayer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <script>
        let art = null;

        function isValidUrl(str) {
            try { new URL(str); return true } catch (_) { return false }
        }

        function showAlert(text) {
            const el = document.getElementById('alert');
            el.textContent = text;
            el.style.display = text ? 'block' : 'none';
        }

        function loadDemo() {
            const demo = 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8';
            document.getElementById('urlInput').value = demo;
            playVideo();
        }

        function createArt(url) {
            if (art) art.destroy();
            art = new Artplayer({
                container: '#player',
                url: url,
                autoplay: false,
                muted: false,
                volume: 0.8,
                playsInline: true,
                theme: '#00b894',
                screenshot: true,
                playbackRate: true,
                fullscreen: true,
                fullscreenWeb: true,
                pip: true,
                hotkey: true,
                mutex: true,
                setting: true,
                autoSize: true,
                moreVideoAttr: { crossOrigin: 'anonymous' }
            });
            return art;
        }

        function setupHlsIfNeeded(url) {
            if (url.includes('.m3u8') && !art.video.canPlayType('application/vnd.apple.mpegurl')) {
                if (!Hls.isSupported()) {
                    showAlert('å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ HLS æ’­æ”¾');
                    return;
                }
                const hls = new Hls({ enableWorker: true, lowLatencyMode: true });
                hls.loadSource(url);
                hls.attachMedia(art.video);
                hls.on(Hls.Events.AUDIO_TRACKS_UPDATED, function (_, data) {
                    if (data && data.audioTracks && data.audioTracks.length > 0) {
                        const idx = data.audioTracks.findIndex(function (t) { return t.default; });
                        hls.audioTrack = idx >= 0 ? idx : 0;
                    }
                });
                hls.on(Hls.Events.MANIFEST_PARSED, function () {
                    try {
                        art.muted = false;
                        if (art.volume === 0) art.volume = 0.8;
                    } catch (e) { }
                });
                hls.on(Hls.Events.ERROR, function (_, data) {
                    if (data && data.fatal) {
                        showAlert('HLS æ’­æ”¾å‘ç”Ÿé”™è¯¯ï¼š' + data.type);
                    }
                });
            }
        }

        function playVideo() {
            showAlert('');
            const url = document.getElementById('urlInput').value.trim();
            if (!url) return showAlert('è¯·å…ˆå¡«å†™æ’­æ”¾åœ°å€');
            if (!isValidUrl(url)) return showAlert('è¯·è¾“å…¥æœ‰æ•ˆçš„ URL');
            const a = createArt(url);
            setupHlsIfNeeded(url);
            a.on('video:error', function () { showAlert('è§†é¢‘æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥åœ°å€æˆ–è·¨åŸŸé…ç½®'); });
        }

        window.addEventListener('DOMContentLoaded', function () {
            const initial = document.getElementById('urlInput').value;
            if (initial) playVideo();
        });
    </script>
</body>

</html>